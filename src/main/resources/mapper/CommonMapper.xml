<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="commonMapper">	
	<!-- 
		根据ID查询实体
	 -->
	<select id="retrieve" parameterType="map" resultType="map">
		select ${selectColumnNames}
		from ${tableName} o
		where o.id = #{id}		
	</select>
	
	<!-- 
		根据某个属性不分页查询实体列表
	 -->
	<select id="findByProperty" parameterType="map" resultType="map">
		select ${selectColumnNames}
		from ${tableName} o
		
		<if test="columnValue != null">		 
		where o.${columnName} = #{columnValue}
		</if>
		
		<if test="columnValues != null">	
		where o.${columnName} in		
			<foreach item="item" index="index" collection="columnValues" open="(" separator="," close=")">
	            #{item}
	        </foreach>	
		</if>
		
		order by o.id desc
	</select>
	
	<!-- 
		根据某个属性查询一个实体
	 -->
	<select id="findOneByProperty" parameterType="map" resultType="map">
		select ${selectColumnNames}
		from ${tableName} o
		where o.${columnName} = #{columnValue}
		order by o.id desc
		limit 1
	</select>
		
	<!-- 根据实体新增一条表记录  -->
    <insert id="create" useGeneratedKeys="true" keyProperty="id" parameterType="map">
		INSERT INTO ${tableName}(${columnNames})
		VALUES
		<foreach item="item" index="index" collection="columnValues" open="(" separator="," close=")">
            #{item}
        </foreach>		
	</insert>
		
	<!-- 更新实体 -->
	<update id="update" parameterType="map">
		update ${tableName}
		set		
			<foreach item="item" index="index" collection="pairs">
            ${item.columnName} = #{item.columnValue},
        	</foreach>                
			updateTime = NOW()			
		where id = #{id}
	</update>
        		
	<!-- 逻辑删除实体-->
	<update id="delete" parameterType="map">
		update ${tableName}
		set 
			deleteStatus = 1,  
			updateTime = NOW()
		<if test="id != null">		  
		where id = #{id}
		</if>
		<if test="ids != null">	
		where id in (${ids})
		</if>
	</update>
	
	<!-- 物理删除实体 -->
    <delete id="deletePhysically" parameterType="map">
		delete from ${tableName}
		<if test="id != null">		  
		where id = #{id}
		</if>
		<if test="ids != null">	
		where id in (${ids})
		</if>
	</delete>   
</mapper>
